import numpy as np
import pylab as mpl
import matplotlib.pyplot as plt
import seaborn

# mpl.rcParams['font.sans-serif'] = ['Times New Roman']
# mpl.rcParams['axes.unicode_minus'] = False

ppl_dict = {
    'LLaMA3-8B-Base': [
        14.9375, 12.9375, 11.0625, 9.5, 8.75, 7.5, 6.375, 6.375, 5.9375, 5.75, 5.5625, 5.4375, 5.71875, 5.53125, 5.84375, 5.84375, 5.75, 5.8125, 5.53125, 5.40625, 5.53125, 5.71875, 5.9375, 6.125, 6.125, 5.96875, 5.9375, 5.84375, 5.9375, 5.9375, 5.9375, 5.96875, 6.0625, 6.0625, 5.96875, 5.9375, 5.8125, 5.84375, 5.71875, 5.75, 5.71875, 5.53125, 5.4375, 5.5, 5.65625, 5.71875, 5.65625, 5.5625, 5.4375, 5.375, 5.28125, 5.28125, 5.15625, 5.125, 5.03125, 5.03125, 5.03125, 4.96875, 4.96875, 5.0, 5.03125, 5.0, 5.0, 5.09375, 5.03125, 5.03125, 4.96875, 5.09375, 5.125, 5.15625, 5.25, 5.28125, 5.25, 5.28125, 5.3125, 5.28125, 5.25, 5.25, 5.1875, 5.1875, 5.15625, 5.125, 5.15625, 5.125, 5.125, 5.09375, 5.125, 5.125, 5.15625, 5.15625, 5.15625, 5.125, 5.09375, 5.03125, 5.03125, 5.03125, 5.03125, 5.125, 5.125, 5.15625, 5.15625, 5.1875, 5.1875, 5.25, 5.375, 5.40625, 5.4375, 5.4375, 5.4375, 5.40625, 5.4375, 5.4375, 5.53125, 5.53125, 5.5, 5.5, 5.53125, 5.4375, 5.4375, 5.5, 5.5, 5.4375, 5.40625, 5.40625, 5.40625, 5.375, 5.3125, 5.28125, 5.25, 5.25, 5.25, 5.25, 5.25, 5.25, 5.28125, 5.3125, 5.375, 5.4375, 5.53125, 5.625, 5.71875, 5.84375, 6.0625, 6.28125, 6.40625, 6.625, 6.84375, 7.0, 7.09375, 7.5, 7.75, 8.0, 8.25, 8.375, 8.625, 8.75, 9.1875, 9.5, 9.8125, 9.9375, 10.25, 10.4375, 10.75, 11.0625, 11.625, 11.8125, 12.0, 12.5625, 12.75, 12.9375, 13.1875, 13.5625, 14.0, 14.4375, 14.9375, 15.1875, 15.375, 15.875, 16.125, 16.875, 17.125, 17.5, 18.0, 18.25, 18.625, 19.125, 19.5, 20.125, 20.75, 21.0, 21.375, 21.75, 22.375, 22.375, 23.5, 23.5, 24.25, 24.25, 25.0, 25.375, 25.75, 25.75, 27.0, 27.5, 27.5, 28.375, 28.75, 28.75, 29.25, 30.125, 30.125, 31.125, 31.625, 32.5, 32.5, 33.0, 33.0, 35.25, 35.75, 36.25, 37.0, 37.5, 37.5, 38.0, 40.0, 40.5, 41.25, 41.75, 41.75, 42.5, 43.75, 44.5, 45.25, 46.0, 46.75, 47.5, 48.25, 49.75, 50.5, 52.0, 53.0, 53.75, 54.5, 56.25, 56.25, 58.0, 58.0, 60.0, 61.75, 61.75
    ], 
    'LLaMA3-8B-Instruct' : [
        20.125, 19.125, 16.625, 15.1875, 13.375, 10.5625, 9.1875, 9.1875, 8.25, 8.125, 8.375, 8.0, 8.25, 8.0, 8.25, 8.25, 8.125, 8.125, 7.75, 7.5, 7.625, 7.75, 8.125, 8.5, 8.375, 8.25, 8.125, 8.0, 8.25, 8.125, 8.125, 8.125, 8.25, 8.375, 8.0, 8.0, 7.75, 7.875, 7.75, 7.875, 7.75, 7.625, 7.375, 7.375, 7.625, 7.75, 7.625, 7.5, 7.34375, 7.15625, 7.09375, 7.0625, 6.9375, 6.78125, 6.6875, 6.625, 6.6875, 6.625, 6.53125, 6.625, 6.625, 6.6875, 6.625, 6.6875, 6.625, 6.625, 6.625, 6.78125, 6.78125, 6.875, 7.0, 7.0, 7.0, 7.0, 7.0, 7.0, 6.9375, 6.84375, 6.84375, 6.78125, 6.78125, 6.71875, 6.71875, 6.71875, 6.71875, 6.71875, 6.71875, 6.71875, 6.71875, 6.78125, 6.78125, 6.6875, 6.625, 6.625, 6.5625, 6.53125, 6.53125, 6.6875, 6.84375, 6.84375, 6.78125, 6.84375, 6.84375, 6.84375, 7.0, 7.0625, 7.09375, 7.09375, 7.09375, 7.09375, 7.09375, 7.09375, 7.21875, 7.28125, 7.28125, 7.21875, 7.15625, 7.15625, 7.15625, 7.15625, 7.15625, 7.15625, 7.09375, 7.09375, 7.09375, 7.0625, 6.9375, 6.9375, 6.875, 6.84375, 6.84375, 6.84375, 6.84375, 6.84375, 6.9375, 6.9375, 7.0, 7.0625, 7.15625, 7.15625, 7.375, 7.5, 7.75, 7.875, 8.0, 8.25, 8.375, 8.5, 8.5, 8.9375, 9.0625, 9.1875, 9.3125, 9.625, 9.625, 9.9375, 10.125, 10.4375, 10.5625, 10.75, 10.9375, 11.0625, 11.25, 11.625, 12.1875, 12.1875, 12.5625, 12.9375, 13.1875, 13.375, 13.8125, 14.25, 14.6875, 14.9375, 15.1875, 15.625, 15.625, 16.125, 16.375, 17.125, 17.75, 18.25, 18.25, 18.875, 18.875, 19.5, 20.125, 20.375, 20.75, 21.0, 21.75, 22.375, 22.375, 23.125, 23.875, 24.25, 24.625, 25.375, 25.75, 26.25, 26.625, 26.625, 27.875, 28.75, 28.75, 29.25, 30.125, 30.625, 31.125, 32.0, 32.5, 33.75, 34.25, 34.75, 34.75, 35.25, 35.75, 38.0, 38.0, 38.0, 38.75, 39.25, 40.0, 40.5, 41.75, 42.5, 42.5, 42.5, 43.25, 44.5, 45.25, 46.0, 46.75, 47.5, 47.5, 48.25, 49.75, 50.5, 51.25, 52.0, 53.0, 53.75, 54.5, 56.25, 56.25, 56.25, 58.0, 60.0, 60.0, 60.0
    ], 
    'LLaDA-8B-Base': [
        31.215599965441594, 15.635950058313327, 15.031746350814204, 10.017377041294852, 8.256935111477564, 7.525485208461095, 7.985191489693327, 8.532730828979332, 7.608915188273775, 7.410531926465482, 7.471988117223264, 7.912616865786797, 8.217873724794813, 8.334566157399937, 8.965991706183758, 8.374734243537858, 7.865086852719313, 7.505556775666931, 7.6387474437014244, 7.716806199663392, 7.906625408063113, 7.826547443851141, 7.820434681185339, 7.773013353043445, 7.6823053487499395, 7.519993049682306, 7.5851127144894175, 7.614007368574815, 7.401337181284581, 7.082590073325164, 7.281449902763494, 7.250632708257208, 7.385190204863756, 7.240351640006626, 7.150823174571431, 7.117459750490899, 7.041011901524979, 7.14131396688932, 7.040747377935942, 7.174369274642432, 6.908463415532484, 6.6952907704209155, 6.617282542212192, 6.6266281413013015, 6.943368413066175, 7.163349689432342, 7.266828983660283, 7.1442882283546005, 7.0175985626424975, 6.809815358106866, 6.605365632966719, 6.504920388842127, 6.512745776581436, 6.303983319282476, 6.254125948376688, 6.175782817733016, 6.16037204764814, 6.098271597670605, 6.08832243719332, 6.018471158799754, 6.101231189198328, 6.1330231739688115, 6.19231266864724, 6.246279638681408, 6.308564195947122, 6.3513573411961834, 6.266276853364549, 6.197741407914564, 6.238450866156455, 6.368893046282213, 6.430820322892907, 6.498839604652489, 6.624221961698937, 6.659843342561861, 6.637067015646085, 6.535000578403961, 6.623806779474312, 6.590760187075854, 6.500062219327069, 6.422939775853884, 6.387339314856706, 6.366051173598784, 6.355988026544827, 6.419292628558981, 6.49201950356815, 6.50392465801976, 6.524574630235263, 6.493391020919108, 6.454417258179848, 6.4990548647396205, 6.568781642350071, 6.541922574705067, 6.525572527643752, 6.488880644922927, 6.429301036653022, 6.491336377003697, 6.410051686437492, 6.386877670991678, 6.451130022294027, 6.4900230342622365, 6.583575285091979, 6.613350518860776, 6.695928100544172, 6.693058399170227, 6.7635071922341, 6.756801560547409, 6.9233881138503035, 7.028897296986769, 7.034633061911196, 7.072288218832691, 7.036653736792537, 6.995942832381456, 7.039851956817035, 7.068983947474231, 7.017336989503497, 7.039576334002366, 7.071885295068534, 7.101866047258819, 7.030640402353992, 7.018517242289501, 6.961387279603931, 6.904072337450267, 6.860666587916588, 6.911942467951614, 6.978101509958631, 6.943476221682916, 6.901647048844326, 6.89616662432893, 6.868015395583732, 6.875920316123156, 6.879673504602549, 6.818817637311625, 6.848408645479323, 6.863628624124874, 6.919489332876996, 6.909812716763575, 6.893682397376075, 6.957150237244219, 6.927788067430783, 6.947660038078617, 6.9345063789830315, 6.925904337515425, 6.945530162533639, 7.025508326656496, 7.045796621342354, 7.046749159370119, 7.1033184840050385, 7.137764112577194, 7.122176226751386, 7.164645096076784, 7.137155050179349, 7.137029786684471, 7.127323659438644, 7.147098782772781, 7.255903835697371, 7.192219844780579, 7.154724802701353, 7.156549204381604, 7.123155292757565, 7.170813111993173, 7.189614670141452, 7.143749797574801, 7.058235130031492, 7.022120813363837, 6.99003666539505, 6.979449534321139, 6.992211297002591, 6.9917247147550485, 7.073082269118717, 7.078803528705634, 7.01132011250281, 7.012936876118699, 7.0171936746287225, 7.0500918072587595, 7.076757317244631, 7.137000461550471, 7.0766110478211965, 7.026706405516082, 7.003560904943472, 6.995866267849627, 6.948686117218292, 6.95367650272566, 6.936544033785841, 6.898163716157902, 6.835324811841622, 6.861384567558508, 6.8325742679645085, 6.8027088037255385, 6.773611591671094, 6.803478568906453, 6.7482584732214, 6.718813213295617, 6.717270645383044, 6.677946236554242, 6.624944882055482, 6.596728060286893, 6.610178586778914, 6.565547870559994, 6.5610749200197676, 6.568782550774787, 6.507595755006346, 6.523162366986279, 6.476274589730972, 6.50234724514566, 6.482812761022524, 6.457086715183274, 6.50687245388926, 6.52666936435223, 6.468406217880967, 6.423556185376323, 6.440320069166522, 6.407369703127251, 6.386369798099357, 6.375067331802796, 6.324300721558993, 6.297648775115306, 6.304841900595934, 6.301055498884993, 6.27911521066224, 6.2665366911393106, 6.264916457374869, 6.303506970690386, 6.346278254500108, 6.36275580289926, 6.438236538821236, 6.422511028852881, 6.387037414003175, 6.381899200761289, 6.40995421066046, 6.409289066040262, 6.424362829674744, 6.447125550662103, 6.466607426514347, 6.50258140617411, 6.5003353981988345, 6.536285671659909, 6.549376669798613, 6.543884036796224, 6.521718893405075, 6.531438217193836, 6.5149661724684345, 6.498981074689645, 6.502924385606996, 6.480615003930579, 6.482151077655006, 6.475344266090059, 6.4701534912729235, 6.467185679725477, 6.470641347923814, 6.46835200950965, 6.47221676283681, 6.458665941557523, 6.46473014796024, 6.457447861777459, 6.420963570909659
    ], 
    'LLaDA-8B-Instruct': [
        21.488220103390674, 21.236578538844455, 20.7813846490413, 17.245732080909402, 12.443621856012372, 9.534163835109135, 8.963033185736979, 8.643642779333355, 8.169917255088496, 8.43842529967077, 9.426302474313154, 9.822586700194892, 9.743389224789144, 9.617303977331211, 9.490795831112784, 9.642376862067236, 9.87497774429867, 9.801472073639422, 9.250886630715607, 9.921821076540564, 10.206679613451383, 10.57621070106594, 10.922901903440252, 11.10293222021639, 10.912459861216538, 10.30596682268114, 10.172234310941882, 10.481844454246044, 10.209915855738293, 10.298246603467328, 10.478661932964982, 10.520886176407842, 10.650407543332788, 10.368751458302249, 10.162382392937458, 10.09867066747591, 10.168638425244206, 10.59139609373048, 10.487894581265193, 10.716540813845993, 10.25023152044307, 9.758503267321059, 9.47549887615146, 9.39723744594226, 9.7044450746539, 9.90654173478695, 9.807576983475562, 9.589998569811197, 9.360991885947877, 9.17281353389875, 9.1052019757222, 9.036065608957399, 8.830348904389545, 8.59552108786613, 8.42794105730301, 8.348287267322183, 8.28376063320556, 8.246212367149157, 8.073288770965886, 7.992107907171555, 7.97704512101963, 8.04085721922584, 8.060075133995781, 8.01039497394845, 8.192883764556996, 8.13500782012844, 8.037685374572467, 7.9657596973477665, 7.924664549574043, 7.926139559932092, 8.18079662876541, 8.162218869863649, 8.30397454793508, 8.388505069546042, 8.48557312008981, 8.551226529418708, 8.519010763004573, 8.332837016844348, 8.256752743258572, 8.24147737097778, 8.263983725381863, 8.271876450596881, 8.2209434408942, 8.151825036103698, 8.10366710150276, 7.9929904073911215, 7.986716898397476, 7.990571372257731, 7.962638879653429, 7.972046523036588, 7.9399001256374975, 7.950937894311953, 7.9066642406486505, 7.863837457680564, 7.8068080743363595, 7.8231707448524075, 7.784040493700461, 7.761867477407588, 7.784828892578422, 7.837670975086094, 7.893160290800521, 7.961270679308158, 8.012051993664873, 8.17200218397134, 8.149582707028571, 8.155285751103595, 8.298172528325164, 8.395091438218962, 8.482968674263697, 8.572616120943557, 8.651279326158564, 8.621459890401164, 8.657583254502072, 8.689068153911045, 8.725672530432314, 8.749854663040013, 8.776545217398594, 8.803227014693142, 8.743580669100163, 8.76546272515898, 8.67841098228123, 8.639802520139495, 8.569346923227283, 8.515124057181485, 8.500649249207923, 8.465261404425284, 8.45532525806631, 8.43495488767312, 8.464503477062092, 8.448231191749667, 8.407353186221805, 8.34315813619307, 8.319599737809348, 8.34978676493025, 8.315058161681225, 8.384463124360378, 8.388324095024888, 8.485828646855282, 8.547655227381936, 8.539608160846065, 8.601449073698689, 8.588765368671085, 8.619403878270631, 8.66710688535702, 8.696965161139874, 8.705396320138346, 8.712172418299321, 8.726200340428724, 8.72543845804308, 8.729317337382744, 8.686141020359388, 8.692145712086324, 8.726454440780621, 8.790305212217296, 8.911938354622558, 8.876001546871361, 8.765226130637576, 8.777110937199263, 8.710209565291155, 8.718390190753857, 8.838115718233825, 8.818126144948158, 8.713789981418765, 8.665623301855977, 8.649628151422556, 8.605886639691093, 8.736447321892433, 8.714167768521587, 8.772044915201432, 8.74804449961673, 8.647654660339878, 8.616798351041934, 8.615402780461329, 8.633506555247033, 8.639813706938352, 8.671072174015425, 8.609185332617349, 8.508998456667502, 8.466883002795548, 8.45880536119881, 8.397833271830553, 8.417319944983538, 8.414786107418616, 8.37538808539126, 8.287549374739427, 8.26331545765366, 8.257806754166841, 8.255090794493297, 8.204036916789324, 8.18090416152759, 8.099321966331493, 8.05301942306742, 8.032382330991044, 8.009734201834618, 7.928030186587907, 7.909285629435085, 7.892657543658793, 7.85541348987676, 7.880059149864683, 7.854024395068605, 7.77392837852095, 7.780696444866186, 7.718985695581614, 7.738797436322837, 7.686715082903719, 7.67828607673687, 7.67087490256606, 7.689302245192047, 7.615612674257093, 7.566433041741517, 7.587727045121962, 7.531777554186748, 7.543120158726112, 7.546076717251367, 7.505624754574766, 7.471454602073076, 7.462646829558187, 7.469966640546512, 7.446424646306798, 7.3943501801583125, 7.395960112305919, 7.457478079235893, 7.493777501526946, 7.567006956625985, 7.643902806263908, 7.677245565938762, 7.739117507406339, 7.723614891240555, 7.734253634788368, 7.710221021850232, 7.722653291119107, 7.7611980153186275, 7.783167825829458, 7.792976677098177, 7.813486730485384, 7.827982750600113, 7.865485593647512, 7.89346865215495, 7.851089650003551, 7.8964846500955606, 7.907210734806524, 7.923583966523582, 7.951287389555553, 7.920522783769807, 7.907975408662956, 7.874987747992427, 7.883236060805292, 7.895871292057997, 7.869573943964885, 7.845479102744145, 7.86478269719948, 7.860474522820284, 7.871003597030237, 7.833492865319142, 7.788963710713078
    ], 
}

niah_dict = {
    'LLaMA3-8B-Base': {
		'Length2000Depth0_origin_en': {'score': 100.0}, 
		'Length2000Depth10_origin_en': {'score': 100.0}, 
		'Length2000Depth20_origin_en': {'score': 100.0}, 
		'Length2000Depth30_origin_en': {'score': 100.0}, 
		'Length2000Depth40_origin_en': {'score': 100.0}, 
		'Length2000Depth50_origin_en': {'score': 100.0}, 
		'Length2000Depth60_origin_en': {'score': 100.0}, 
		'Length2000Depth70_origin_en': {'score': 100.0}, 
		'Length2000Depth80_origin_en': {'score': 100.0}, 
		'Length2000Depth90_origin_en': {'score': 100.0}, 
		'Length2000Depth100_origin_en': {'score': 100.0}, 
		'Length4000Depth0_origin_en': {'score': 100.0}, 
		'Length4000Depth10_origin_en': {'score': 100.0}, 
		'Length4000Depth20_origin_en': {'score': 100.0}, 
		'Length4000Depth30_origin_en': {'score': 100.0}, 
		'Length4000Depth40_origin_en': {'score': 100.0}, 
		'Length4000Depth50_origin_en': {'score': 100.0}, 
		'Length4000Depth60_origin_en': {'score': 100.0}, 
		'Length4000Depth70_origin_en': {'score': 100.0}, 
		'Length4000Depth80_origin_en': {'score': 100.0}, 
		'Length4000Depth90_origin_en': {'score': 100.0}, 
		'Length4000Depth100_origin_en': {'score': 100.0}, 
		'Length8000Depth0_origin_en': {'score': 100.0}, 
		'Length8000Depth10_origin_en': {'score': 100.0}, 
		'Length8000Depth20_origin_en': {'score': 100.0}, 
		'Length8000Depth30_origin_en': {'score': 100.0}, 
		'Length8000Depth40_origin_en': {'score': 100.0}, 
		'Length8000Depth50_origin_en': {'score': 100.0}, 
		'Length8000Depth60_origin_en': {'score': 100.0}, 
		'Length8000Depth70_origin_en': {'score': 100.0}, 
		'Length8000Depth80_origin_en': {'score': 100.0}, 
		'Length8000Depth90_origin_en': {'score': 100.0}, 
		'Length8000Depth100_origin_en': {'score': 100.0}, 
		'Length16000Depth0_origin_en': {'score': 3.955578202023016}, 
		'Length16000Depth10_origin_en': {'score': 3.814358520895154}, 
		'Length16000Depth20_origin_en': {'score': 3.389939684805654}, 
		'Length16000Depth30_origin_en': {'score': 3.5647477858276977}, 
		'Length16000Depth40_origin_en': {'score': 3.41768610989437}, 
		'Length16000Depth50_origin_en': {'score': 3.4158382534870824}, 
		'Length16000Depth60_origin_en': {'score': 3.2570884072896567}, 
		'Length16000Depth70_origin_en': {'score': 3.3172103889231854}, 
		'Length16000Depth80_origin_en': {'score': 3.346333696112411}, 
		'Length16000Depth90_origin_en': {'score': 3.308409397536356}, 
		'Length16000Depth100_origin_en': {'score': 3.530094127304376}, 
		'Length24000Depth0_origin_en': {'score': 3.816289812600785}, 
		'Length24000Depth10_origin_en': {'score': 3.8801882233454608}, 
		'Length24000Depth20_origin_en': {'score': 3.712333058962397}, 
		'Length24000Depth30_origin_en': {'score': 3.57047673840194}, 
		'Length24000Depth40_origin_en': {'score': 3.753657209745467}, 
		'Length24000Depth50_origin_en': {'score': 3.777985348144155}, 
		'Length24000Depth60_origin_en': {'score': 3.676910191650002}, 
		'Length24000Depth70_origin_en': {'score': 3.6506695250024364}, 
		'Length24000Depth80_origin_en': {'score': 3.628475087255798}, 
		'Length24000Depth90_origin_en': {'score': 3.6317158379227665}, 
		'Length24000Depth100_origin_en': {'score': 3.6741107459202}, 
		'Length32000Depth0_origin_en': {'score': 2.9442774159743488}, 
		'Length32000Depth10_origin_en': {'score': 3.0268215785369144}, 
		'Length32000Depth20_origin_en': {'score': 2.978469304854226}, 
		'Length32000Depth30_origin_en': {'score': 3.2533993732580013}, 
		'Length32000Depth40_origin_en': {'score': 2.8608639769098962}, 
		'Length32000Depth50_origin_en': {'score': 3.171727716002395}, 
		'Length32000Depth60_origin_en': {'score': 3.0616042268478187}, 
		'Length32000Depth70_origin_en': {'score': 3.075137387226193}, 
		'Length32000Depth80_origin_en': {'score': 3.1226106428354994}, 
		'Length32000Depth90_origin_en': {'score': 3.0329053802681587}, 
		'Length32000Depth100_origin_en': {'score': 3.110238195812485}
    }, 
    'LLaMA3-8B-Instruct': {
		'Length2000Depth0_origin_en': {'score': 90.37837837837837}, 
		'Length2000Depth10_origin_en': {'score': 100.0}, 
		'Length2000Depth20_origin_en': {'score': 100.0}, 
		'Length2000Depth30_origin_en': {'score': 81.28487365870544}, 
		'Length2000Depth40_origin_en': {'score': 90.33333333333334}, 
		'Length2000Depth50_origin_en': {'score': 90.33333333333334}, 
		'Length2000Depth60_origin_en': {'score': 90.33333333333334}, 
		'Length2000Depth70_origin_en': {'score': 81.23071458172993}, 
		'Length2000Depth80_origin_en': {'score': 80.71171171171171}, 
		'Length2000Depth90_origin_en': {'score': 80.71171171171171}, 
		'Length2000Depth100_origin_en': {'score': 90.37837837837837}, 
		'Length4000Depth0_origin_en': {'score': 90.3731343283582}, 
		'Length4000Depth10_origin_en': {'score': 100.0}, 
		'Length4000Depth20_origin_en': {'score': 100.0}, 
		'Length4000Depth30_origin_en': {'score': 90.66165413533835}, 
		'Length4000Depth40_origin_en': {'score': 81.22881831444282}, 
		'Length4000Depth50_origin_en': {'score': 100.0}, 
		'Length4000Depth60_origin_en': {'score': 90.66165413533835}, 
		'Length4000Depth70_origin_en': {'score': 81.29580047680176}, 
		'Length4000Depth80_origin_en': {'score': 81.19788601939631}, 
		'Length4000Depth90_origin_en': {'score': 81.01370838525904}, 
		'Length4000Depth100_origin_en': {'score': 80.75197583689906}, 
		'Length8000Depth0_origin_en': {'score': 90.42735042735043}, 
		'Length8000Depth10_origin_en': {'score': 90.38571428571429}, 
		'Length8000Depth20_origin_en': {'score': 90.55223880597015}, 
		'Length8000Depth30_origin_en': {'score': 90.36496350364965}, 
		'Length8000Depth40_origin_en': {'score': 90.36496350364965}, 
		'Length8000Depth50_origin_en': {'score': 100.0}, 
		'Length8000Depth60_origin_en': {'score': 90.35555555555555}, 
		'Length8000Depth70_origin_en': {'score': 90.35555555555555}, 
		'Length8000Depth80_origin_en': {'score': 100.0}, 
		'Length8000Depth90_origin_en': {'score': 100.0}, 
		'Length8000Depth100_origin_en': {'score': 90.38571428571429}, 
		'Length16000Depth0_origin_en': {'score': 3.5705017639222305}, 
		'Length16000Depth10_origin_en': {'score': 3.7718933009296256}, 
		'Length16000Depth20_origin_en': {'score': 3.3968781977208073}, 
		'Length16000Depth30_origin_en': {'score': 3.4606092023781527}, 
		'Length16000Depth40_origin_en': {'score': 3.558577740759143}, 
		'Length16000Depth50_origin_en': {'score': 3.5311288307711415}, 
		'Length16000Depth60_origin_en': {'score': 3.4329180031799007}, 
		'Length16000Depth70_origin_en': {'score': 3.5914161088478176}, 
		'Length16000Depth80_origin_en': {'score': 3.547603317865215}, 
		'Length16000Depth90_origin_en': {'score': 3.3606714996833973}, 
		'Length16000Depth100_origin_en': {'score': 3.5553519245884972}, 
		'Length24000Depth0_origin_en': {'score': 3.3145166403207673}, 
		'Length24000Depth10_origin_en': {'score': 3.3208293172464662}, 
		'Length24000Depth20_origin_en': {'score': 3.7010730844738133}, 
		'Length24000Depth30_origin_en': {'score': 3.689621886548649}, 
		'Length24000Depth40_origin_en': {'score': 3.573080835316987}, 
		'Length24000Depth50_origin_en': {'score': 3.3362615900063135}, 
		'Length24000Depth60_origin_en': {'score': 3.288194557760524}, 
		'Length24000Depth70_origin_en': {'score': 3.288194557760524}, 
		'Length24000Depth80_origin_en': {'score': 3.288194557760524}, 
		'Length24000Depth90_origin_en': {'score': 3.3981945577605237}, 
		'Length24000Depth100_origin_en': {'score': 3.235488391347652}, 
		'Length32000Depth0_origin_en': {'score': 2.4731366996818798}, 
		'Length32000Depth10_origin_en': {'score': 1.9208024499246477}, 
		'Length32000Depth20_origin_en': {'score': 2.1175531667194476}, 
		'Length32000Depth30_origin_en': {'score': 2.1788650422778058}, 
		'Length32000Depth40_origin_en': {'score': 1.9651122448567935}, 
		'Length32000Depth50_origin_en': {'score': 1.9957320790193223}, 
		'Length32000Depth60_origin_en': {'score': 2.261448785836582}, 
		'Length32000Depth70_origin_en': {'score': 2.165767789683888}, 
		'Length32000Depth80_origin_en': {'score': 2.128031940627284}, 
		'Length32000Depth90_origin_en': {'score': 2.128031940627284}, 
		'Length32000Depth100_origin_en': {'score': 2.126351313530453}
    }, 
    'LLaDA-8B-Base': {
		'Length2000Depth0_origin_en': {'score': 100.0}, 
		'Length2000Depth10_origin_en': {'score': 100.0}, 
		'Length2000Depth20_origin_en': {'score': 100.0}, 
		'Length2000Depth30_origin_en': {'score': 100.0}, 
		'Length2000Depth40_origin_en': {'score': 100.0}, 
		'Length2000Depth50_origin_en': {'score': 100.0}, 
		'Length2000Depth60_origin_en': {'score': 100.0}, 
		'Length2000Depth70_origin_en': {'score': 100.0}, 
		'Length2000Depth80_origin_en': {'score': 100.0}, 
		'Length2000Depth90_origin_en': {'score': 100.0}, 
		'Length2000Depth100_origin_en': {'score': 100.0}, 
		'Length4000Depth0_origin_en': {'score': 100.0}, 
		'Length4000Depth10_origin_en': {'score': 100.0}, 
		'Length4000Depth20_origin_en': {'score': 100.0}, 
		'Length4000Depth30_origin_en': {'score': 100.0}, 
		'Length4000Depth40_origin_en': {'score': 100.0}, 
		'Length4000Depth50_origin_en': {'score': 100.0}, 
		'Length4000Depth60_origin_en': {'score': 100.0}, 
		'Length4000Depth70_origin_en': {'score': 100.0}, 
		'Length4000Depth80_origin_en': {'score': 100.0}, 
		'Length4000Depth90_origin_en': {'score': 100.0}, 
		'Length4000Depth100_origin_en': {'score': 100.0}, 
		'Length8000Depth0_origin_en': {'score': 4.700679394220694}, 
		'Length8000Depth10_origin_en': {'score': 4.29118535359655}, 
		'Length8000Depth20_origin_en': {'score': 13.872474716319505}, 
		'Length8000Depth30_origin_en': {'score': 4.644095850571923}, 
		'Length8000Depth40_origin_en': {'score': 61.48321967260274}, 
		'Length8000Depth50_origin_en': {'score': 100.0}, 
		'Length8000Depth60_origin_en': {'score': 100.0}, 
		'Length8000Depth70_origin_en': {'score': 100.0}, 
		'Length8000Depth80_origin_en': {'score': 100.0}, 
		'Length8000Depth90_origin_en': {'score': 100.0}, 
		'Length8000Depth100_origin_en': {'score': 100.0}, 
		'Length16000Depth0_origin_en': {'score': 5.661801557895577}, 
		'Length16000Depth10_origin_en': {'score': 5.622672736186065}, 
		'Length16000Depth20_origin_en': {'score': 5.843090061328022}, 
		'Length16000Depth30_origin_en': {'score': 5.617648734318405}, 
		'Length16000Depth40_origin_en': {'score': 5.931713500948121}, 
		'Length16000Depth50_origin_en': {'score': 6.001014262081467}, 
		'Length16000Depth60_origin_en': {'score': 5.497573678292468}, 
		'Length16000Depth70_origin_en': {'score': 5.667443147821325}, 
		'Length16000Depth80_origin_en': {'score': 100.0}, 
		'Length16000Depth90_origin_en': {'score': 100.0}, 
		'Length16000Depth100_origin_en': {'score': 100.0}, 
		'Length24000Depth0_origin_en': {'score': 4.963310490191196}, 
		'Length24000Depth10_origin_en': {'score': 5.054142095701048}, 
		'Length24000Depth20_origin_en': {'score': 4.537515059657501}, 
		'Length24000Depth30_origin_en': {'score': 4.801166503733159}, 
		'Length24000Depth40_origin_en': {'score': 5.018685960822426}, 
		'Length24000Depth50_origin_en': {'score': 4.935725731307151}, 
		'Length24000Depth60_origin_en': {'score': 4.910711291643793}, 
		'Length24000Depth70_origin_en': {'score': 4.997351987613704}, 
		'Length24000Depth80_origin_en': {'score': 4.6526419696785215}, 
		'Length24000Depth90_origin_en': {'score': 90.29457364341086}, 
		'Length24000Depth100_origin_en': {'score': 100.0}, 
		'Length32000Depth0_origin_en': {'score': 3.870724509538114}, 
		'Length32000Depth10_origin_en': {'score': 4.176837927059076}, 
		'Length32000Depth20_origin_en': {'score': 3.979273276540834}, 
		'Length32000Depth30_origin_en': {'score': 3.7557044844658583}, 
		'Length32000Depth40_origin_en': {'score': 3.9167490293613247}, 
		'Length32000Depth50_origin_en': {'score': 3.924985543776618}, 
		'Length32000Depth60_origin_en': {'score': 4.101317546440129}, 
		'Length32000Depth70_origin_en': {'score': 4.122466367547554}, 
		'Length32000Depth80_origin_en': {'score': 4.107608129796786}, 
		'Length32000Depth90_origin_en': {'score': 3.892856439917338}, 
		'Length32000Depth100_origin_en': {'score': 71.57156166814552}
    }, 
    'LLaDA-8B-Instruct': {
		'Length2000Depth0_origin_en': {'score': 100.0}, 
		'Length2000Depth10_origin_en': {'score': 100.0}, 
		'Length2000Depth20_origin_en': {'score': 100.0}, 
		'Length2000Depth30_origin_en': {'score': 100.0}, 
		'Length2000Depth40_origin_en': {'score': 100.0}, 
		'Length2000Depth50_origin_en': {'score': 100.0}, 
		'Length2000Depth60_origin_en': {'score': 90.35374149659864}, 
		'Length2000Depth70_origin_en': {'score': 100.0}, 
		'Length2000Depth80_origin_en': {'score': 100.0}, 
		'Length2000Depth90_origin_en': {'score': 90.42424242424242}, 
		'Length2000Depth100_origin_en': {'score': 100.0}, 
		'Length4000Depth0_origin_en': {'score': 100.0}, 
		'Length4000Depth10_origin_en': {'score': 100.0}, 
		'Length4000Depth20_origin_en': {'score': 100.0}, 
		'Length4000Depth30_origin_en': {'score': 100.0}, 
		'Length4000Depth40_origin_en': {'score': 100.0}, 
		'Length4000Depth50_origin_en': {'score': 100.0}, 
		'Length4000Depth60_origin_en': {'score': 100.0}, 
		'Length4000Depth70_origin_en': {'score': 100.0}, 
		'Length4000Depth80_origin_en': {'score': 100.0}, 
		'Length4000Depth90_origin_en': {'score': 90.4360902255639}, 
		'Length4000Depth100_origin_en': {'score': 100.0}, 
		'Length8000Depth0_origin_en': {'score': 13.759822654411257}, 
		'Length8000Depth10_origin_en': {'score': 13.639063689557233}, 
		'Length8000Depth20_origin_en': {'score': 23.115124407066492}, 
		'Length8000Depth30_origin_en': {'score': 14.140713069136655}, 
		'Length8000Depth40_origin_en': {'score': 80.77278208441}, 
		'Length8000Depth50_origin_en': {'score': 100.0}, 
		'Length8000Depth60_origin_en': {'score': 100.0}, 
		'Length8000Depth70_origin_en': {'score': 100.0}, 
		'Length8000Depth80_origin_en': {'score': 100.0}, 
		'Length8000Depth90_origin_en': {'score': 100.0}, 
		'Length8000Depth100_origin_en': {'score': 100.0}, 
		'Length16000Depth0_origin_en': {'score': 4.221726547852791}, 
		'Length16000Depth10_origin_en': {'score': 4.14880322926385}, 
		'Length16000Depth20_origin_en': {'score': 3.8003142535463454}, 
		'Length16000Depth30_origin_en': {'score': 4.107636678658605}, 
		'Length16000Depth40_origin_en': {'score': 4.173052537518885}, 
		'Length16000Depth50_origin_en': {'score': 4.130942440403301}, 
		'Length16000Depth60_origin_en': {'score': 4.116522447748491}, 
		'Length16000Depth70_origin_en': {'score': 3.739108642917869}, 
		'Length16000Depth80_origin_en': {'score': 80.76521739130435}, 
		'Length16000Depth90_origin_en': {'score': 90.40298507462687}, 
		'Length16000Depth100_origin_en': {'score': 100.0}, 
		'Length24000Depth0_origin_en': {'score': 4.351837221215318}, 
		'Length24000Depth10_origin_en': {'score': 4.087575138851376}, 
		'Length24000Depth20_origin_en': {'score': 4.033899595277184}, 
		'Length24000Depth30_origin_en': {'score': 4.13096601682714}, 
		'Length24000Depth40_origin_en': {'score': 4.342704335725307}, 
		'Length24000Depth50_origin_en': {'score': 4.311520333815464}, 
		'Length24000Depth60_origin_en': {'score': 4.111736986686991}, 
		'Length24000Depth70_origin_en': {'score': 4.129820183863647}, 
		'Length24000Depth80_origin_en': {'score': 4.127310925565743}, 
		'Length24000Depth90_origin_en': {'score': 62.041159012808485}, 
		'Length24000Depth100_origin_en': {'score': 90.37837837837837}, 
		'Length32000Depth0_origin_en': {'score': 3.7647783839273528}, 
		'Length32000Depth10_origin_en': {'score': 3.3173461589394244}, 
		'Length32000Depth20_origin_en': {'score': 3.5726719604550916}, 
		'Length32000Depth30_origin_en': {'score': 3.5103745714846353}, 
		'Length32000Depth40_origin_en': {'score': 3.578554782205976}, 
		'Length32000Depth50_origin_en': {'score': 3.6529694251862743}, 
		'Length32000Depth60_origin_en': {'score': 3.521140319687622}, 
		'Length32000Depth70_origin_en': {'score': 3.5572595597516354}, 
		'Length32000Depth80_origin_en': {'score': 3.4710161880112507}, 
		'Length32000Depth90_origin_en': {'score': 3.524176120032192}, 
		'Length32000Depth100_origin_en': {'score': 13.479082253627729}
    }, 
}

color_dict = {
    'LLaMA3-8B-Base': '#1F77B4', 
    'LLaMA3-8B-Instruct': '#2BA02B', 
    'LLaDA-8B-Base': '#D62727', 
    'LLaDA-8B-Instruct': '#FF7F0F', 
}

fig = plt.figure(figsize=(6, 3.5), dpi=200)
ax = fig.add_subplot(1, 1, 1)

for model in ppl_dict:

    ppl_line = ppl_dict[model]
    num_sample = len(ppl_line)

    ppl_line = np.array(ppl_line[::2])
    num_sample = (np.arange(len(ppl_line))*2 + 1) * 64
    l, = ax.plot(num_sample, ppl_line, lw=2, ls='-', label=model, color=color_dict[model])

ax.set_ylim((ax.get_ylim()[0], ax.get_ylim()[1] - 30))

ax.set_xticks([0, 4000, 8000, 12000, 16000], [0, 4000, 8000, 12000, 16000])
ax.set_xticklabels(ax.get_xticklabels(), fontsize=12)
ax.set_yticklabels(ax.get_yticklabels(), fontsize=12)
ax.set_xlabel('Context Length', fontsize=14, labelpad=6)
ax.set_ylabel('Perplexity', fontsize=14)

plt.legend(fontsize=12, loc='upper left')
plt.subplots_adjust(left=0.12, bottom=0.15, right=0.92, top=0.96, hspace=0.25, wspace=0.2)
plt.savefig('diffusion_ppl_gov.png')


fig = plt.figure(figsize=(6, 3.5), dpi=200)
ax = fig.add_subplot(1, 1, 1)

depths = (np.arange(11) * 10).tolist()
lengths = [2000, 4000, 8000, 16000, 24000, 32000]

for model in niah_dict:

    niah_model_dict = niah_dict[model]
    niah_line = [np.mean([niah_model_dict[f'Length{length}Depth{depth}_origin_en']['score'] for depth in depths]) for length in lengths]
    l, = ax.plot(niah_line, lw=2, ls='-', label=model, color=color_dict[model],  #
            	 marker='o', markerfacecolor='white', markeredgewidth=2, markeredgecolor=color_dict[model])

ax.set_xticks(range(len(lengths)), lengths)

ax.set_xticklabels(ax.get_xticklabels(), fontsize=12)
ax.set_yticklabels(ax.get_yticklabels(), fontsize=12)

ax.set_xlabel('Context Length', fontsize=14, labelpad=6)
ax.set_ylabel('Retrieval Accuracy', fontsize=14)

plt.legend(fontsize=12, loc='lower left')
plt.subplots_adjust(left=0.12, bottom=0.15, right=0.92, top=0.96, hspace=0.25, wspace=0.2)
plt.savefig('diffusion_niah.png')